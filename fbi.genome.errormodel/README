THIS CODE IS NO LONGER FOUND HERE: REFACTORED TO THE SIMULATOR