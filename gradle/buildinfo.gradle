// collect build info
private String exec ( String command, File directory = null )
{
    final process = command.execute(( List ) null, directory )
    ( process.text + process.err.text ).trim()
}
private String find ( String prefix, String command ) { find( prefix, exec( command ).readLines()) }
private String find ( String prefix, List<String> l ) { l.find{ it.startsWith( prefix ) }?.replace( prefix, '' )?.trim() ?: '' }

def gitBranch = "${ find( '# On branch', 'cmd /c git status' ) }"
def gitVersion = "${ find( 'commit',      'cmd /c git log -1' )}"
def buildDate  = "${new Date().toString()}"

subprojects.each{project->
    project.ext.gitBranch = "${gitBranch}"
    project.ext.gitVersion = "${gitVersion}"
    project.ext.buildDate = "${buildDate}"
}
